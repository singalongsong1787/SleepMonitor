# 利用加速度传感器的睡眠分期方法

（1）**收集整夜的加速度采样数据。**

为了减少程序运行的缓存大小，对1s内的数据取模场进行差分变换，只保留其最大值最为该点的强度。

（2）**设置觉醒阈值。**

根据自己初步的实验，目前将觉醒阈值调成为1，但可以设置为更小，或者改为动态阈值。

依此找出觉醒区域。（*5分钟为一个窗口监测，若有1个点大于1，那么该时间窗口全部记为觉醒区间。*）

（3）**去除掉觉醒数据，求取整夜的均方值（RMS）。**

（4）**找寻深睡区间，剩下的为浅睡区间。**

以1min作为时间窗口探测。

<span style="color:red">**深睡条件：**</span>（1）该时间窗的RMS小于整夜的RMS。

                    （2）该时间窗内没有大于1.5倍的RMS（时间窗）的值。

（5） **输出觉醒、浅睡和深睡区间，保存起来。**

<span style="color:blue">**参考流程图如下：**</span>

<center>
 <img src=".\images\flowChart_acc.png" width="500" style="margin: 0 10px;">
</center>

# 利用陀螺仪传感器的翻身监测方法

（1） **收集陀螺仪的采样数据**

这次不需要作差分变换，**取模**即可。

1min作为1个窗口，处理玩数据释放即可，只需要保留处理结果即可，不需要保留原数据。

（2） **高斯滤波**

文献表示：高斯滤波能够去除陀螺仪底部噪声，但个人感觉意义不大，原因如下：*陀螺仪的底部噪声相对于翻身带来的变化是很小的，我们检测的是这个时间窗口内的峰值*

（3） **阈值设置**

阈值设置为0.05，认为0.05是陀螺仪对应的底噪。

（4） **峰值检测**

对1min的数据进行峰值检测，使用python中的find_peaks<span style="color:red">**find_peaks函数**</span>，最小高度为0.05，最小间隔设为5s（即如果5s内有多次翻动，那么归为一个大动作）

（5）  **对检测到的峰值进行二次检测**

查看检测到的峰值周围有多少个点超过阈值，本方法设置为周围100个数据点有60个超过阈值。

<span style="color:blue">这样做的好处是：可以避免踢腿、伸展等行为被误检测为翻身活动。原理：翻身活动持续的时间较长。</span>

<span style="color:red">**本质根据阈值和时长进行区分。**</span>

<span style="color:blue">**参考流程图如下：**</span>

<center>
<img src=".\images\flowChart_gy.png" width="500" style="margin: 0 10px;">
</center>
